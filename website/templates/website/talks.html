{#	TODO: limit keywords/projects by page size to avoid overflow #}
{#	TODO: auto-add using bibtex #}

{% extends "website/base.html" %}

{% block pagetitle %}Talks{% endblock %}

{% load staticfiles %}
{% load thumbnail %}

{% block stylesheets %}

<link rel="stylesheet" href="{% static 'website/css/talks.css' %}">
<link rel="stylesheet" href="{% static 'website/css/fixed_side_bar.css' %}">

{% endblock %}

{% block external_scripts %}

<script src="{% static 'website/js/fixedSideBar.js' %}"></script>
<script src="{% static 'website/js/filterBar.js' %}"></script>
<script src="{% static 'website/js/talks.js' %}"></script>

{% endblock %}

{% block scripts %}

	var talks = [
		{% for talk in talks %}
		{
			"id": "A.###",
			"title": "{{talk.title}}",
			"authors": [
				{% for author in talk.authors.all %}
				{
					"name": "{{author.get_full_name}}",
					"first_name": "{{author.first_name}}",
					"middle_name": "{{author.middle_name}}",
					"last_name": "{{author.last_name}}",
					"link": "{% url 'website:member' author.id %}"
				},
				{% endfor %}
			],
			"date": new Date("{{talk.date.isoformat}}"),
			"pdf": "../../media/{{ talk.pdf_file }}",
			"thumbnail": "{% thumbnail talk.thumbnail 300x0 detail %}",
			"venue": "{{talk.book_title_short}}",
			"talk_type": "{{talk.talk_venue_type}}",
			{% if talk.award %}"award": "{{ talk.award }}",{% endif %}
			{% if talk.total_papers_accepted and pub.total_papers_submitted %}
			"total_papers_accepted": {{talk.total_papers_accepted}},
			"total_papers_submitted": {{talk.total_papers_submitted}},
			{% endif %}
			{% if talk.page_num_start %} "start_page": {{talk.page_num_start}},{% endif %}
			{% if talk.page_num_end %} "end_page": {{talk.page_num_end}},{% endif %}
			{% if talk.num_pages %} "num_pages": {{talk.num_pages}},{% endif %}
			"to_appear": {% if talk.to_appear %}true{% else %}false{% endif %},
			"keywords": [
				{% for keyword in talk.keywords.all %}
					"{{keyword.keyword}}",
				{% endfor %}
			],
			"projects": [
				{% for project in talk.projects.all %}
					"{{project.short_name}}",
				{% endfor %}
			]
		},
		{% endfor %}
	];

{% endblock %}

{% block maincarousel %}
    <div id="mainCarousel" class="carousel slide carousel-fade shortCarousel" data-ride="carousel" data-interval="5000" data-pause="false">
        <div class="overlay carousel-caption">
            <div class="container">
                <div class="overlay-spacer"></div>
                <div class="overlay-title">Talks</div>
            </div>
        </div>
        <!-- Wrapper for slides -->
        <div class="carousel-inner" role="listbox">
            <div class="item active">
                <div class="fill" style="background-image:url({% static 'website/img/banner1.jpg' %})"></div>
                <!-- <div class="carousel-caption">
                    This is a caption for carousel item 1.
                </div> -->
            </div>
            <div class="item">
                <div class="fill" style="background-image:url({% static 'website/img/banner2.jpg' %})"></div>
                <!-- <div class="carousel-caption">
                    This is a caption for carousel item 2.
                </div> -->
            </div>
            <div class="item">
                <div class="fill" style="background-image:url({% static 'website/img/banner3.png' %})"></div>
                <!-- <div class="carousel-caption">
                    This is a caption for carousel item 3.
                </div> -->
            </div>
        </div>
    </div>
{% endblock %}

{% block content %}
    <div id="content" class="container">
        <div id="fixed-side-bar">
            <div id="filter-bar">
            </div>
        </div>
        <div class="talk-list" id="main-content">
            Loading content... (Please make sure JavaScript is enabled)
            <h1 class="group-template" name="Group Name"></h1>
            <div class="talk-template">
                <div class="talk-id">id</div>
                <div class="talk-info">
                    <p class="talk-title">Paper Title</p>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block temp %}
 {% if talks %}
            There are {{ talks.count }} talks loaded in the system
             <ul>
            {% for talk in talks %}
                <li>{{ talk.title }}
                <br/>
{#                <a href="{{ talk.thumbnail.url }}">{{  talk.thumbnail.url }}</a></li> #}
            {% endfor %}
            </ul>
        {% else %}
            <p>No publications are available.</p>
        {% endif %}
        <p><hr></p>
        {% if talks %}
            <div class="row">
                {% for talk in talks %}
                    <div class="col-md-2">
 {#                        <img src="{{ talk.thumbnail.url }}" class="thumbnail img-responsive"/> #}
                        {{ talk.title }}
                    </div>
                {% endfor %}

            </div>
        {% else %}
            <p>No people are available.</p>
        {% endif %}
    </div>
{% endblock %}